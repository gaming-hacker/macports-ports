# -*- coding: utf-8; mode: _tcl; tab-width: 2; indent-tabs-mode: nil; c-basic-offset: 2 -*- vim:fenc=utf-8:ft=tcl:et:sw=2:ts=2:sts=2

PortSystem          1.0

name                mkcert
version             1.1.0
platforms           darwin
categories          security devel
license             AS-IS
installs_libs       no
maintainers         {gmail.com:herby.gillot @herbygillot}
description         A simple zero-config tool to make locally trusted development certificates with any names you'd like
long_description    mkcert is a simple tool for making locally-trusted development \
                    certificates. It requires no configuration. Using certificates from \
                    real certificate authorities (CAs) for development can be dangerous \
                    or impossible (for hosts like localhost or 127.0.0.1), but self-signed \
                    certificates cause trust errors. Managing your own CA is the best solution, \
                    but usually involves arcane commands, specialized knowledge and manual steps. \
                    \
                    mkcert automatically creates and installs a local CA in the system root store, \
                    and generates locally-trusted certificates.
homepage            https://github.com/FiloSottile/mkcert
platforms           darwin
use_zip             yes

master_sites        https://github.com/FiloSottile/mkcert/archive

distfiles           v${version}.zip

extract.only        v${version}.zip

checksums           v${version}.zip \
rmd160  2e8ae6c5821195eaa72f21e74dd057b17a2f6633 \
sha256  57ca37f51029a7c9352205be0a759dfac95b700a2de599a0aacf8282e77888bd \

depends_build       port:go
use_configure       no

build.cmd           ${prefix}/bin/go
build.target        build
build.env           GOPATH=${workpath}

post-extract {
    file mkdir ${workpath}/src/

    ln -sf ${worksrcpath}/vendor/golang.org          ${workpath}/src/golang.org
    ln -sf ${worksrcpath}/vendor/github.com          ${workpath}/src/github.com
    ln -sf ${worksrcpath}/vendor/software.sslmate.com          ${workpath}/src/software.sslmate.com
}

destroot {
    xinstall -m 755 ${worksrcpath}/${name}-${version} ${destroot}${prefix}/bin/${name}
}

livecheck.url       https://github.com/FiloSottile/${name}/tags
livecheck.regex     archive/v(\[^"\]+)${extract.suffix}
