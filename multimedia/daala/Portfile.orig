# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4

PortSystem          1.0
PortGroup           xcodeversion 1.0
PortGroup           muniversal 1.0

name                kvazaar
epoch               1
version             1.1.2
revision            1
license             LGPL-2.1+
categories          multimedia
maintainers         nomaintainer

description          An open-source HEVC encoder.

long_description    An open-source HEVC encoder licensed under LGPLv2.1 \
Kvazaar is still under development. Speed and RD-quality \
will continue to improve.

platforms           darwin
homepage            http://ultravideo.cs.tut.fi/#encoder
master_sites        file:///Volumes/Apps_Media/alexander_repo

use_bzip2              yes
distfiles           ${name}-${version}.tar.bz2
checksums           rmd160 255f2d55812c9a2bd117c8715b997a2d3264b734 \
                    sha256 bf968f2a429ead16c6dbd572d66858b2a2187d48e17cf422bafd6af280d85dee

# root directory of extracted tarball is owned by root and has permissions 0700
# set to 0755 to facilitate maintenance

post-extract {
    file attributes ${worksrcpath} -permissions 0755
}

depends_build       port:pkgconfig \
                    port:gmake

configure.compiler  macports-clang-5.0
configure.cc        clang-mp-5.0
configure.cxx       clang++-mp-5.0
configure.cpp       clang-cpp-mp-5.0

configure.optflags   -O3 -pipe -m64 -arch x86_64 \
                    -march=native -mtune=native  \
                    -mmacosx-version-min=10.12 \
                    -fomit-frame-pointer -fno-common \
                    -mavx2 -mfma -mfpmath=sse \
                    -msse2 -msse3 -msse4.1 -msse4.2 \
                    -Wno-unknown-warning-option \
                    -Wno-unused-function \
                    -Wno-unused-variable \
                    -Wno-unused-command-line-argument \
                    -l1-cache-line-size=64 \
                    -l1-cache-size=32 \
                    -l2-cache-size=256

configure.cflags    -std=c11
configure.cxxflags  -std=c++14
configure.args      --enable-static \
                    --disable-shared \
                    --disable-dependency-tracking \
                    --enable-fast-install \
                    --enable-asm \
                    --with-pic

test.run            no

livecheck.type      none
