# -*- coding: utf-8; mode: _tcl; tab-width: 2; indent-tabs-mode: nil; c-basic-offset: 2 -*- vim:fenc=utf-8:ft=tcl:et:sw=2:ts=2:sts=2

# Based on Portfile for kde-cmake-extra-modules

# Potentially to be replaced as part of
# https://trac.macports.org/ticket/49925

PortSystem          1.0
PortGroup           qt5     1.0
PortGroup           cmake   1.1

name                ki18n
subport ${name}-devel {}

set kf5.branch      5.47

if {${subport} eq "${name}-devel"} {
    fetch.type      git
    git.url         https://anongit.kde.org/ki18n.git
#    v5.47.0
    git.branch      5faba1bbc39588c120e22d7cf619322b441cd49f
    version         5.47.0
} else {
    version         ${kf5.branch}.0
    set branch      [join [lrange [split ${version} .] 0 1] .]
    master_sites    https://download.kde.org/stable/frameworks/${branch}/

    distname        ${name}-${version}
    use_xz          yes

    checksums       rmd160  5525340b79b1d8f477258adad392ad680a0d7358 \
sha256  2627faa0186e9b463d978e842bf6df1e7d27e7e9d487793f6709e82a1c0729a8 \
size    586888
}

categories          kde kf5 devel
license             GPL-2+
maintainers         {@chrstphrchvz gmx.us:chrischavez} openmaintainer
description         KDE Gettext-based UI text internationalization
long_description    \
"KI18n provides functionality for internationalizing user interface text
in applications, based on the GNU Gettext translation system.
It wraps the standard Gettext functionality, so that the programmers
and translators can use the familiar Gettext tools and workflows.

KI18n provides additional functionality as well, for both programmers
and translators, which can help to achieve a higher overall quality
of source and translated text. This includes argument capturing,
customizable markup, and translation scripting."

platforms           darwin
homepage            https://projects.kde.org/projects/kdesupport/ki18n

qt5.depends_component \
                    qtscript

configure.args-append \
                    -DECM_MKSPECS_INSTALL_DIR=${qt_mkspecs_dir}/modules

if {${subport} eq ${name}} {
    depends_build-append  \
                    port:kde-extra-cmake-modules
} elseif {${subport} eq "${name}-devel"} {
    depends_build-append  \
                    port:kde-extra-cmake-modules-devel
}

# # Not used here, but these are used when configuring KF5 packages (cf KF5 PortGroup):
# configure.args-append \
#                     -DCMAKE_DISABLE_FIND_PACKAGE_X11=ON \
#                     -DAPPLE_SUPPRESS_X11_WARNING=ON \
#                     -DCMAKE_INSTALL_LIBEXECDIR=${prefix}/libexec \
#                     -DKDE_INSTALL_LIBEXECDIR=${prefix}/libexec/kde5

# See issue with livecheck in kde-extra-cmake-modules
livecheck.type      none